<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>业绩明细</title>
    <link rel="stylesheet" href="../css/weui-min.css" />
    <link rel="stylesheet" href="../css/example.css" />
    <style>
        a :focus {
            background-color: #cc99cc;
            outline: none;
        }

        #modal-overlay {
            position: absolute; /* 使用绝对定位或固定定位  */
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            text-align: center;
            z-index: 1000;
            background-color: #fff;
        }

        #modal-overlay-opa {
            position: absolute; /* 使用绝对定位或固定定位  */
            left: 0px;
            top: 0px;
            width: 100%;
            height: 100%;
            text-align: center;
            z-index: 1000;
            background-color: #fff;
            opacity: 0.5;
        }

        /* 模态框样式 */
        .modal-data {
            margin: 80% auto;
            padding: 15px;
            text-align: center;
            opacity: 0.5;
        }
    </style>
</head>

<body style="background-color: #f2f2f2;font-size: 15px;">
    <div id="detail" style="height:100%">


        <div class="weui-flex" style="justify-content: center;align-items: center;height: 16%;">
            <div class="box weui-flex" style="flex: 0 0 100%;height:70%; background-image: url(../src/background.png);border-radius: 5px;align-items: center">
                <div class="item weui-flex__item" style="margin-left: 10px">
                    <h3 style="color: #d9d9d9;font-size: 15px;font-weight: 200">本月排名</h3>
                    <span style="color: white;font-size: 15px" v-text="rank"></span>
                </div>
                <div class="item weui-flex__item" style="margin-left: 10px">
                    <h3 style="color: #d9d9d9;font-size: 15px;font-weight: 200">获得奖金（元）</h3>
                    <span style="color: white;font-size: 15px" v-text="'￥'+final_salary"></span>
                </div>
            </div>
        </div>

        <div class="weui-panel weui-panel_access" style="background-color: white;border-radius: 5px">
            <div class="weui-panel__hd">业绩排行</div>


            <div  v-for="(it,idx) in yejilist " class="display-block" style="border-bottom: 1px solid #f2f2f2;">
                <a href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg ">
                    <div class="weui-media-box__hd" style="border-radius: 50%;background-color: #ffcc99;height: 50px;width: 50px; justify-content: center;align-items: center; display: flex;">
                        <span v-text="idx+1"></span>
                    </div>
                    <!--这里我建议前三名用不同的颜色标明一下吧，就像点钟那个页面不同的点钟排钟颜色不一样那样-->
                    <!--<div class="weui-media-box__hd"-->
                    <!--style="border-radius: 50%;background-color: #9fc5e8;height: 50px;width: 50px; justify-content: center;align-items: center; display: flex;">-->
                    <!--<span>点钟</span>-->
                    <!--</div>-->
                    <div class="weui-media-box__bd">
                        <h4 class="weui-media-box__title" style="font-size: 14px" v-text="it['job_number']"></h4>
                    </div>
                    <div class="weui-media-box__bd" style="float: right;text-align: right">
                        <h4 class="weui-media-box__title" style="color: #cc99cc" v-text="'￥'+it['final_salary']"></h4>
                    </div>
                </a>
            </div>
            <!-- <div class="display-block" style="border-bottom: 1px solid #f2f2f2;">
            <a href="javascript:void(0);" class="weui-media-box weui-media-box_appmsg ">
                <div class="weui-media-box__hd"
                     style="border-radius: 50%;background-color: #ffcc99;height: 50px;width: 50px; justify-content: center;align-items: center; display: flex;">
                    <span>2</span>
                </div>
                <div class="weui-media-box__bd">
                    <h4 class="weui-media-box__title" style="font-size: 14px">KKB333</h4>
                </div>
                <div class="weui-media-box__bd" style="float: right;text-align: right">
                    <h4 class="weui-media-box__title" style="color: #cc99cc">￥19933</h4>
                </div>
            </a>
        </div> -->

        </div>
        <div class="weui-footer" style="margin-top: 20px">
            <p class="weui-footer__text">查帐方式以结账时间为准</p>
        </div>
        <div :id="opa?'modal-overlay-opa':'modal-overlay'" v-show="show">
            <div class="modal-data">
                <img src="../src/loading.gif" />
            </div>
        </div>
    </div>

</body>
<script type="text/javascript" src="../js/jquery.js"></script>
<!-- <script src="https://vuejs.org/js/vue.js"></script> -->
<script src="../js/vue.js"></script>
<script type="text/javascript" src="../js/jweixin.js"></script>
<!-- <script type="text/javascript" src="example.js"></script> -->
<script type="text/javascript" src="../js/weui-min.js"></script>
<script type="text/javascript" src="../js/zepto.js"></script>
<script type="text/javascript" src="../js/sweetalert2.all.js"></script>
<script>
    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return unescape(r[2]);
        return null;
    }
    let app = new Vue({
        el: '#detail',
        data: {
            yejilist: [],
            self_job_number:"",
            rank:"",
            final_salary:0,
            show:true,
            opa:false,
        },
        created() {
            var that = this;
            $.post("../php/getyeji.php").done((res) => {
                res = JSON.parse(res);
                if (res.status == 1) {
                    for (var i = 0; i < res.data.length; i++) {
                        that.yejilist.push(res.data[i])
                    }
                    for (var i = 0; i < that.yejilist.length - 1; i++) {
                        highest = i;
                        for (var j = i + 1; j < that.yejilist.length; j++) {
                            if (that.yejilist[i]['final_salary'] < that.yejilist[j]['final_salary']) {
                                highest = j;
                            }
                        }
                        if (highest != i) {
                            var tp = that.yejilist[i];
                            that.yejilist[i] = that.yejilist[highest];
                            that.yejilist[highest] = tp;
                        }
                    }
                    that.self_job_number = getQueryString('id');
                    for(var i = 0; i < res.data.length; i++){
                        if(that.self_job_number == res.data[i]['job_number'])
                            that.rank = i+1;
                            that.final_salary = res.data[i]['final_salary']
                    }
                    that.show = false;
                    that.opa = true;
                }
            })
        }
    })
</script>


</html>